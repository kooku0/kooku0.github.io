<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-books/test-driven-development/01" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">1부 화폐 예제 | 고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kooku0.github.io/docs/books/test-driven-development/01/"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="1부 화폐 예제 | 고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다."><meta data-rh="true" name="description" content="1부에서는 완전히 테스트에 의해 주도되는 전형적 모델 코드를 개발할 것이다. 내 목표는 여러분이 테스트 주도 개발의 리듬을 보도록 하는 것이다. 그 리듬은 다음과 같이 요약할 수 있다."><meta data-rh="true" property="og:description" content="1부에서는 완전히 테스트에 의해 주도되는 전형적 모델 코드를 개발할 것이다. 내 목표는 여러분이 테스트 주도 개발의 리듬을 보도록 하는 것이다. 그 리듬은 다음과 같이 요약할 수 있다."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kooku0.github.io/docs/books/test-driven-development/01/"><link data-rh="true" rel="alternate" href="https://kooku0.github.io/docs/books/test-driven-development/01/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://kooku0.github.io/docs/books/test-driven-development/01/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"1부 화폐 예제","item":"https://kooku0.github.io/docs/books/test-driven-development/01"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KVSM4B0KPY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KVSM4B0KPY",{})</script>



<link rel="alternate" type="application/rss+xml" href="/tech/rss.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tech/atom.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/fintech/rss.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fintech/atom.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/retrospect/rss.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/retrospect/atom.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/journal/rss.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/journal/atom.xml" title="고민한 내용, 경험한 내용, 공부한 내용들을 기록하는 공간입니다. Atom Feed"><link rel="stylesheet" href="/assets/css/styles.45053ef1.css">
<script src="/assets/js/runtime~main.cca4ccc4.js" defer="defer"></script>
<script src="/assets/js/main.78a0e4da.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/favicon.ico"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="메인" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="사이드바 펼치거나 접기" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/favicon.ico" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kooku&#x27;s log</b></a><a class="navbar__item navbar__link" href="/fintech/">핀테크</a><a class="navbar__item navbar__link" href="/tech/">테크</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/books/">Book</a><a class="navbar__item navbar__link" href="/journal/">Journal</a><a class="navbar__item navbar__link" href="/docs/smartfarm/">Smartfarm</a><a class="navbar__item navbar__link" href="/docs/stock/financial-statements/">Stock</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="맨 위로 스크롤하기" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="문서 사이드바" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/books/">책 목록</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/books/clean-code/introduction/">테크</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/clean-code/introduction/">클린코드</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/object/introduction/">오브젝트</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/frameworkless-front-end-development/introduction/">프레임워크 없는 프론트엔드 개발</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/introduction/">만들면서 배우는 클린 아키텍처</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/functional-programming-in-scala/introduction/">스칼라로 배우는 함수형 프로그래밍</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/effective-typescript/introduction/">이펙티브 타입스크립트</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/the-pragmatic-programmer/introduction/">실용주의 프로그래머</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/books/test-driven-development/introduction/">테스트 주도 개발</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/test-driven-development/introduction/">책 소개</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/test-driven-development/preface/">저자의 글</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/books/test-driven-development/01/">1부 화폐 예제</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/books/test-driven-development/01/">1부 화폐 예제</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/functional-programming-in-javascript/introduction/">함수형 자바스크립트</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/designing-for-performance/introduction/">디자이너를 위한 웹 성능 최적화 기법</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/grokking-simplicity/introduction/">쏙쏙 들어오는 함수형 코딩</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/unit-testing/introduction/">단위 테스트</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/books/atomic-habit/09/">자기계발</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/books/growth-hacking/01/">경영</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/books/around-industries-in-40-days/introduction/">핀테크</a></div></li></ul></nav><button type="button" title="사이드바 숨기기" aria-label="사이드바 숨기기" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="탐색 경로"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="홈" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">테크</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">테스트 주도 개발</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">1부 화폐 예제</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">이 페이지에서</button></div><div class="theme-doc-markdown markdown"><header><h1>1부 화폐 예제</h1></header><p>1부에서는 완전히 테스트에 의해 주도되는 전형적 모델 코드를 개발할 것이다. 내 목표는 여러분이 테스트 주도 개발의 리듬을 보도록 하는 것이다. 그 리듬은 다음과 같이 요약할 수 있다.</p>
<ol>
<li>재빨리 테스트를 하나 추가한다.</li>
<li>모든 테스트를 실행하고 새로 추가한 것이 실패하는지 확인한다.</li>
<li>코드를 조금 바꾼다.</li>
<li>모든 테스트를 실행하고 전부 성공하는지 확인한다.</li>
<li>리팩토링을 통해 중복을 제거한다.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1장-다중-통화를-지원하는-money-객체">1장. 다중 통화를 지원하는 Money 객체<a href="#1장-다중-통화를-지원하는-money-객체" class="hash-link" aria-label="1장. 다중 통화를 지원하는 Money 객체에 대한 직접 링크" title="1장. 다중 통화를 지원하는 Money 객체에 대한 직접 링크">​</a></h2>
<p>다중 통화를 지원하는 Money 객체부터 시작해보자. 다음과 같은 보고서가 있다고 하자.</p>
<table><thead><tr><th>종목</th><th>주</th><th>가격</th><th>합계</th></tr></thead><tbody><tr><td>IBM</td><td>1000</td><td>25</td><td>25000</td></tr><tr><td>GE</td><td>400</td><td>100</td><td>40000</td></tr><tr><td></td><td></td><td>합계</td><td>65000</td></tr></tbody></table>
<p>다중 통화를 지원하는 보고서를 만들려면 통화 단위를 추가해야 한다.</p>
<table><thead><tr><th>종목</th><th>주</th><th>가격</th><th>합계</th></tr></thead><tbody><tr><td>IBM</td><td>1000</td><td>25USD</td><td>25000USD</td></tr><tr><td>Novartis</td><td>400</td><td>150CHF</td><td>60000CHF</td></tr><tr><td></td><td></td><td>합계</td><td>65000USD</td></tr></tbody></table>
<p>또한 환율도 명시해야 한다.</p>
<table><thead><tr><th>기준</th><th>변환</th><th>환율</th></tr></thead><tbody><tr><td>CHF</td><td>USD</td><td>1.5</td></tr></tbody></table>
<p>새로운 보고서를 생성하려면 어떤 기능들이 있어야 할까? 즉 어떤 테스트들이 있어야 보고서에 제대로 계산되도록 하는 코드가 완성됐다는 걸 확신할 수 있을까?</p>
<ul>
<li>통화가 다른 두 금액을 더해서 주어진 환율에 맞게 변환 금액을 결과로 얻을 수 있어야 한다.</li>
<li>어떤 금액(주가)을 어떤 수(주식의 수)에 곱한 금액을 결과로 얻을 수 있어야 한다.</li>
</ul>
<p>테스트를 작성할 때는 오퍼레이션의 완벽한 인터페이스에 대해 상상해보는 것이 좋다. 우리는 지금 오퍼레이션이 외부에서 어떤 식으로 보일지에 대한 이야기를 테스트 코드에 적고 있는 것이다. 가능한 최선의 API에서 시작해서 거꾸로 작업하는 것이 애초부터 일을 복잡하고 보기 흉하며 &#x27;현실적&#x27; 이게 하는 것보다 낫다.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><strong>$5 x 2 = $10</strong></li>
<li>amount를 private으로 만들기</li>
<li>Dollar 부작용(side effect)?</li>
<li>Money 반올림?</li>
</ul></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testMultiplication() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar five = new Dollar(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  five.times(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(10, five.amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>우리가 작성한 테스트는 아직 컴파일조차 되지 않는다. 현재 네 개의 컴파일 에러가 있다.</p>
<ul>
<li>Dollar 클래스가 없음</li>
<li>생성자가 없음</li>
<li>times(int) 메서드가 없음</li>
<li>amount 필드가 없음</li>
</ul>
<p>한 번에 하나씩 정복하기로 하자. Dollar 클래스를 정의하면 에러 하나는 없앨 수 있다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Dollar</span><br></span></code></pre></div></div>
<p>에러가 하나 없으졌으니 이제 세 개 남았다. 이제 생성자를 만들어보자. 그냥 컴파일만 되게 할 꺼니까 생성자 안에서는 아무 일도 안 해도 된다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dollar(int amount) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이제 에러가 두 개 남았다. 이제 times()의 스텁 구현이 필요하다. 이번에도 역시 컴파일만 될 수 있게 해주는 최소한의 구현만 할 것이다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">void times(int multiplier) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이제 하나 남았다. 마지막으로 amount 필드를 추가하자.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int amount;</span><br></span></code></pre></div></div>
<p>이제 테스트를 실행해서 테스트가 실패하는 모습을 볼 수 있게 됐다.</p>
<p>우린 지금 공포의 빨간 막대를 보고 있다. 이것도 일종의 진척이다. 이제 실패에 대한 구체적인 척도를 갖게 된 것이다. 우리 문제는 &#x27;다중 통화 구현&#x27;에서 &#x27;이 테스트를 통과시킨 후 나머지 테스트들도 통과시키기&#x27;로 변형된 것이다. 훨씬 간단하다.</p>
<p>내가 상상할 수 있는 최소 작업은 다음과 같다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int amount = 10;</span><br></span></code></pre></div></div>
<p>이제 초록 막대를 보게 된다. 계속 진행하기 전에 일반화해야 한다. 주기는 다음과 같다.</p>
<ol>
<li>작은 테스트를 하나 추가한다.</li>
<li>모든 테스트를 실행해서 테스트가 실패하는 것을 확인한다.</li>
<li>조금 수정한다.</li>
<li>모든 테스트를 실행해서 테스트가 성공하는 것을 확인한다.</li>
<li>중복을 제거하기 위해 리팩토링을 한다.</li>
</ol>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>의존성과 중복</div><div class="admonitionContent_BuS1"><p>스티브 프리만은 테스트와 코드 간의 문제는 중복이 아님을 지적한 바 있다. 문제는 테스트와 코드 사이에 존재하는 의존성이다. 즉 코드나 테스트 중 한쪽을 수정하면 반드시 다른 한쪽도 수정해야만 한다는 것이다. 우리의 목표는 코드를 바꾸지 않으면서도 뭔가 의미 있는 테스트를 하나 더 작성하는 것인데, 현재의 구현으로는 불가능하다.</p><p>의존성이 문제 그 자체라면 중복은 그 문제의 징후다. 중복의 가장 흔한 예는 로직의 중복이다. 중복된 로직을 하나로 끄집어내는 일엔 객체를 이용하는 것이 최고다.</p><p>문제 자체는 남겨둔 채로 징후만 제거하면 다른 어딘가에서 최악의 형태로 문제가 드러나곤 하는 현실 세계의 일반적인 양상과는 달리, 프로그램에서는 중복만 제거해 주면 의존성도 제거된다. 이게 바로 TDD의 두 번째 규칙이 존재하는 이유다. 다음 테스트로 진행하기 전에 중복을 제거함으로써, 오직 한 가지의 코드 수정을 통해 다음 테스트도 통과되게 만들 가능성을 최대화하는 것이다.</p></div></div>
<p>주기의 1번부터 4번 항목까지를 수행했다. 이제 중복을 제거할 차례다. 그런데 어디가 중복이란 말인가? 보통 여러분은 중복을 찾기 위해 코드를 비교할 것이다. 하지만 이번 경우엔 중복이 테스트에 있는 데이터와 코드에 있는 데이터 사이에 존재한다.
코드를 다음과 같이 썼다면 어땠을까?</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int amount = 5 * 2;</span><br></span></code></pre></div></div>
<p>여기에서 10은 다른 어딘가에서 넘어온 값이다. 사실 우린 우리가 인식조차 할 수 없을 만큼 빨리 머릿속으로 곱셈을 수행한 것이다. 이제 5와 2가 두 곳에 존재한다. 따라서 우린 무자비하게 이 중복을 제거해야 한다.</p>
<p>5와 2를 한 번에 제거할 수 있는 방법은 없다. 하지만 객체 초기화 단계에 있는 설정 코드를 times() 메서드 안으로 옮겨보면 어떨까?</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void times(int multiplier) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount = 5 * 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>테스트는 여전히 통과하고 테스트 막대 역시 초록색이다.</p>
<p>이 단계가 너무 작게 느껴지는가? 하지만 기억하기 바란다. TDD의 핵심은 이런 작은 단계를 밟아야 한다는 것이 아니라, 이런 작은 단계를 밟을 능력을 갖추어야 한다는 것이다.</p>
<p>다시 시작해보자. 5를 어디서 얻을 수 있을까? 이건 생성자에서 넘어오는 값이니 이걸 다음과 같이 amount 변수에 저장하면,</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dollar(int amount) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  this.amount = amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>그걸 times()에서 사용할 수 있다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">void times(int multiplier) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount = amount * 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>인자 <code>multiplier</code>의 값이 2 이므로, 상수를 이 인자로 대체할 수 있다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">void times(int multiplier) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount *= multiplier;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이제 첫 번째 테스트에 완료 표시를 할 수 있게 됐다.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li>amount를 private으로 만들기</li>
<li>Dollar 부작용(side effect)?</li>
<li>Money 반올림?</li>
</ul></div></div>
<p>우리는 다음 작업들을 해냈다.</p>
<ul>
<li>우리가 알고 있는 작업해야 할 테스트 목록을 만들었다.</li>
<li>오퍼레이션이 외부에서 어떻게 보이길 원하는지 말해주는 이야기를 코드로 표현했다.</li>
<li>JUnit에 대한 상세한 사항들은 잠시 무시하기로 했다.</li>
<li>스텁 구현을 통해 테스트를 컴파일했다.</li>
<li>끔찍한 죄악을 범하여 테스트를 통과시켰다.</li>
<li>돌아가는 코드에서 상수를 변수로 변경하여 점진적으로 일반화했다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2장-타락한-객체">2장. 타락한 객체<a href="#2장-타락한-객체" class="hash-link" aria-label="2장. 타락한 객체에 대한 직접 링크" title="2장. 타락한 객체에 대한 직접 링크">​</a></h2>
<p>일반적인 TDD 주기는 다음과 같다.</p>
<ol>
<li>테스트를 작성한다. 마음속에 있는 오퍼레이션이 코드에 어떤 식으로 나타나길 원하는지 생각해보라. 이야기를 써내려가는 것이다. 원하는 인터페이스를 개발하라. 올바른 답을 얻기 위해 필요한 이야기의 모든 요소를 포함시켜라.</li>
<li>실행 가능하게 만든다. 다른 무엇보다도 중요한 것은 빨리 초록 막대를 보는 것이다. 깔끔하고 단순한 해법이 명백히 보인다면 그것을 입력하라.</li>
<li>올바르게 만든다. 이제 시스템이 작동하므로 직전에 저질렀던 죄악을 수습하자. 중복을 제거하고 초록 막대로 되돌리자.</li>
</ol>
<p>우리의 목적은 작동하는 깔끔한 코드를 얻는 것이다. 하지만 도달하기 힘든 목표이기에 나누어서 정복해야한다. 일단 &#x27;작동하는 깔끔한 코드&#x27;를 얻어야 한다는 전체 문제 중에서 &#x27;작동하는&#x27;에 해당하는 부분을 먼저 해결하라. 그러고 나서 &#x27;깔끔한 코드&#x27; 부분을 해결하는 것이다. 이러한 접근 방식은 &#x27;깔끔한 코드&#x27; 부분을 먼저 해결한 후에, &#x27;작동하는&#x27; 부분을 해결해 가면서 배운 것들을 설계에 반영하느라 허둥거리는 아키텍처 주도 개발과 정반대다.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li>amount를 private으로 만들기</li>
<li><strong>Dollar 부작용(side effect)?</strong></li>
<li>Money 반올림?</li>
</ul></div></div>
<p>Dollar에 대해 연산을 수행한 후에 해당 Dollar의 값이 바뀌는 점을 수정해야 한다. 나는 다음과 같이 쓸 수 있길 바란다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testMultiplication() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar five = new Dollar(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar product = five.times(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(10, product.amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  product = five.times(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(15, product.amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Dollar.times()를 아래와 같이 수정하기 전엔 새 테스트는 컴파일조차 되지 않을 것이다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dollar times(int multiplier) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  amount *= multiplier;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이제 테스트가 컴파일된다. 하지만 실행되지는 않는다. 그래도 한 걸음 나아갔다. 테스트를 통과하기 위해 올바른 금액을 갖는 새 Dollar를 반환해야 한다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dollar times(int multiplier) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return new Dollar(amount * multiplier);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li>amount를 private으로 만들기</li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
</ul></div></div>
<p>다음은 최대한 빨리 초록색을 보기 위해 취할 수 있는 내가 아는 세 전략 중 두 가지다.</p>
<ul>
<li>가짜로 구현하기: 상수를 반환하게 만들고 진짜 코드를 얻을 때까지 단계적으로 상수를 변수로 바꾸어 간다.</li>
<li>명백한 구현 사용하기: 실제 구현을 입력한다.</li>
</ul>
<p>나는 보통 실무에서 TDD를 사용할 때 두 방법을 번갈아가며 사용한다. 모든 일이 자연스럽게 잘 진행되고 내가 뭘 입력해야 할지 알 때는 명백한 구현을 계속 더해 나간다(나에게 명백한 사실이 컴퓨터에게도 명백한 사실인지 확인하기 위해 구현 사이에 테스트를 한 번씩 실행한다.)</p>
<p>지금까지 배운 것을 검토해보자.</p>
<ul>
<li>설계상의 결함(Dollar 부작용)을 그 결함으로 인해 실패하는 테스트로 변환했다.</li>
<li>스텁 구현으로 빠르게 컴파일을 통과하도록 만들었다.</li>
<li>올바르다고 생각하는 코드를 입력하여 테스트를 통과했다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3장-모두를-위한-평등">3장. 모두를 위한 평등<a href="#3장-모두를-위한-평등" class="hash-link" aria-label="3장. 모두를 위한 평등에 대한 직접 링크" title="3장. 모두를 위한 평등에 대한 직접 링크">​</a></h2>
<p>지금의 Dollar 객체같이 객체를 값처럼 쓸 수 있는데 이것을 값 객체 패턴(value object pattern)이라고 한다. 값 객체에 대한 제약사항 중 하나는 객체의 인스턴스 변수가 생성자를 통해서 일단 설정된 후에는 결코 변하지 않는다는 것이다.</p>
<p>값 객체를 사용하면 별칭 문제에 대해 걱정할 필요가 없다는 아주 큰 장점이 있다. $5가 있을 때 그것이 영원히 $5임을 보장 받을 수 있다. 누군가가 $7를 원한다면 새로운 객체를 만들어야 할 것이다.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li>amount를 private으로 만들기</li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li>equals()</li>
</ul></div></div>
<p>값 객체가 암시하는 것 중 하나는 모든 연산은 새 객체를 반환해야 한다는 것이다. 또다른 암시는 값 객체는 equals()를 구현해야 한다는 것인데, 왜냐하면 $5라는 것은 항상 다른 $5만큼이나 똑같이 좋은 것이기 때문이다.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li>amount를 private으로 만들기</li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><strong>equals()</strong></li>
<li>hashCode()</li>
</ul></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testEquality() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertTrue(new Dollar(5).equals(new Dollar(5)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>빨간 막대다. 가짜로 구현하는 방법은 단순히 true를 반환하는 것이다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public boolean equals(Object object) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>삼각측량을 위해 두 번째 예제가 필요하다. $5 != $6을 해보는게 어떨까?</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testEquality() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertTrue(new Dollar(5).equals(new Dollar(5)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertFalse(new Dollar(5).equals(new Dollar(6)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이제 동치성(equality)을 일반화해야 한다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public boolean equals(Object object) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar dollar = (Dollar) object;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return amount == dollar.amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li>amount를 private으로 만들기</li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><del>equals()</del></li>
<li>hashCode()</li>
</ul></div></div>
<p>내가 생각하기에 삼각측량은 조금 이상한 면이 있다. 그래서 나는 어떻게 리팩토링해야 하는지 전혀 감이 안 올 때만 삼각측량을 사용한다. 코드와 테스트 사이의 중복을 제거하고 일반적인 해법을 구할 방법이 보이면 그냥 그 방법대로 구현한다. 왜 한번에 끝낼 수 있는 일을 두고 또다른 테스트를 만들어야 하는가?</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li>amount를 private으로 만들기</li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><del>equals()</del></li>
<li>hashCode()</li>
<li>Equal null</li>
<li>Equal object</li>
</ul></div></div>
<p>동질성 기능을 구현했으므로 Dollar와 Dollar를 직접 비교할 수 있게 됐다. 따라서 모든 올바른 인스턴스 변수들이 그럿듯 amount를 private으로 만들 수 있게 됐다.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4장-프라이버시">4장. 프라이버시<a href="#4장-프라이버시" class="hash-link" aria-label="4장. 프라이버시에 대한 직접 링크" title="4장. 프라이버시에 대한 직접 링크">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li><strong>amount를 private으로 만들기</strong></li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><del>equals()</del></li>
<li>hashCode()</li>
<li>Equal null</li>
<li>Equal object</li>
</ul></div></div>
<p>동치성 문제를 정의했으므로 이를 이용하여 테스트가 조금 더 많은 이야기를 해줄 수 있도록 만들자. 개념적으로 Dollar.times() 연산은 호출을 받은 객체의 값에 인자로 받은 곱수만큼 곱한 값을 갖는 Dollar를 반환해야 한다. 하지만 테스트가 정확히 그것을 말하지는 않는다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testMultiplication() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar five = new Dollar(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar product = five.times(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(10, product.amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  product = five.times(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(15, product.amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>첫 번째 단언을 Dollar와 Dollar를 비교하는 것으로 재작성할 수 있다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testMultiplication() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar five = new Dollar(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar product = five.times(2);</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  assertEquals(new Dollar(10), product);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  product = five.times(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(15, product.amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이게 더 좋아보이므로 두 번째 단언도 마찬가지로 고쳐보자.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testMultiplication() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar five = new Dollar(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar product = five.times(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(new Dollar(10), product);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  product = five.times(3);</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  assertEquals(new Dollar(15), product);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이제 임시 변수인 product는 더 이상 쓸모없어 보인다. 인라인시켜보자.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testMultiplication() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dollar five = new Dollar(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(new Dollar(10), five.times(2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(new Dollar(15), five.times(3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>이 테스트는 일련의 오퍼레이션이 아니라 참인 명제에 대한 단언들이므로 우리의 의도를 더 명확하게 이야기해준다.</p>
<p>테스트를 고치고 나니 이제 Dollar의 amount 인스턴스 변수를 사용하는 코드는 Dollar 자신밖에 없게 됐다. 따라서 변수를 private으로 변경할 수 있다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private int amount;</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li><del>amount를 private으로 만들기</del></li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><del>equals()</del></li>
<li>hashCode()</li>
<li>Equal null</li>
<li>Equal object</li>
</ul></div></div>
<p>우리는 완벽함을 위해 노력하지는 않는다. 모든 것을 두 번 말함으로써(코드와 테스트로 한 번씩) 자신감을 가지고 전진할 수 있을 만큼만 결함의 정도를 낮추기를 희망할 뿐이다. 때때로 우리의 추론이 맞지 않아서 결함이 발생할 수 있다. 그럴 때면 테스트를 어떻게 작성해야 했는지에 대한 교훈을 얻고 다시 앞으로 나아간다. 그 이후에는 초록 막대 아래서 대담하게 나아갈 수 있다.</p>
<ul>
<li>오직 테스트를 향상시키기 위해서만 개발된 기능을 사용했다.</li>
<li>두 테스트가 동시에 실패하면 망한다는 점을 인식했다.</li>
<li>위험 요소가 있음에도 계속 진행했다.</li>
<li>테스트와 코드 사이의 결합도를 낮추기 위해, 테스트하는 객체의 새 기능을 사용했다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5장-솔직히-말하자면">5장. 솔직히 말하자면<a href="#5장-솔직히-말하자면" class="hash-link" aria-label="5장. 솔직히 말하자면에 대한 직접 링크" title="5장. 솔직히 말하자면에 대한 직접 링크">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li><del>amount를 private으로 만들기</del></li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><del>equals()</del></li>
<li>hashCode()</li>
<li>Equal null</li>
<li>Equal object</li>
<li><strong>5CHF x 2 = 10CHF</strong></li>
</ul></div></div>
<p>첫 번째 테스트에 어떤 식으로 접근하는게 좋을까? 너무 큰 것 같아 작은 단계 하나로 구현하는 테스트를 작성해낼 수 있을지 확실치 않다. 우선은 Dollar 객체와 비슷하지만 달러 대신 프랑(Franc)을 표현할 수 있는 객체가 필요할 것 같다. Dollar 객체와 비슷하게 작동하는 Franc 객체를 만든다면 단위가 섞인 덧셈 테스트를 작성하고 돌려보는 데 더 가까워질 것이다.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void testFrancMultiplication() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Franc five = new Franc(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(new Franc(10), five.times(2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  assertEquals(new Franc(15), five.times(3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>우선 Dollar 코드를 복사해서 Dollar를 Franc으로 바꾸어 보자.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Franc {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private int amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Franc(int amount) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.amount = amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Franc times(int multiplier) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new Franc(amount * multiplier);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public boolean equals(Object object) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Franc franc = (Franc) object;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return amount == franc.amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li><del>amount를 private으로 만들기</del></li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><del>equals()</del></li>
<li>hashCode()</li>
<li>Equal null</li>
<li>Equal object</li>
<li><del>5CHF x 2 = 10CHF</del></li>
<li>Dollar/Franc 중복</li>
<li>공용 equals</li>
<li>공용 times</li>
</ul></div></div>
<p>코드를 실행시키기까지의 단계가 짧았기 때문에 &#x27;컴파일되게 하기&#x27; 단계도 넘어갈 수 있었다.</p>
<p>중복이 엄청나게 많기 때문에 다음 테스트를 작성하기 전에 이것들을 제거해야 한다. equals()를 일반화하는 것부터 시작하자.</p>
<ul>
<li>큰 테스트를 공략할 수 없다. 그래서 진전을 나타낼 수 있는 자그마한 테스트를 만들었다.</li>
<li>뻔뻔스럽게도 중복을 만들고 조금 고쳐서 테스트를 작성했다.</li>
<li>설상가상으로 모델 코드까지 도매금으로 복사하고 수정해서 테스트를 통과했다.</li>
<li>중복이 사라지기 전에는 집에 가지 않겠다고 약속했다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6장-돌아온-모두를-위한-평등">6장. 돌아온 &#x27;모두를 위한 평등&#x27;<a href="#6장-돌아온-모두를-위한-평등" class="hash-link" aria-label="6장. 돌아온 &#x27;모두를 위한 평등&#x27;에 대한 직접 링크" title="6장. 돌아온 &#x27;모두를 위한 평등&#x27;에 대한 직접 링크">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_BuS1"><ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li><del>$5 x 2 = $10</del></li>
<li><del>amount를 private으로 만들기</del></li>
<li><del>Dollar 부작용(side effect)?</del></li>
<li>Money 반올림?</li>
<li><del>equals()</del></li>
<li>hashCode()</li>
<li>Equal null</li>
<li>Equal object</li>
<li><del>5CHF x 2 = 10CHF</del></li>
<li>Dollar/Franc 중복</li>
<li><strong>공용 equals</strong></li>
<li>공용 times</li>
</ul></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kooku0/kooku0.github.io/edit/main/docs/books/test-driven-development/01.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="문서 페이지"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/books/test-driven-development/preface/"><div class="pagination-nav__sublabel">이전</div><div class="pagination-nav__label">저자의 글</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/books/test-driven-development/01/"><div class="pagination-nav__sublabel">다음</div><div class="pagination-nav__label">1부 화폐 예제</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1장-다중-통화를-지원하는-money-객체" class="table-of-contents__link toc-highlight">1장. 다중 통화를 지원하는 Money 객체</a></li><li><a href="#2장-타락한-객체" class="table-of-contents__link toc-highlight">2장. 타락한 객체</a></li><li><a href="#3장-모두를-위한-평등" class="table-of-contents__link toc-highlight">3장. 모두를 위한 평등</a></li><li><a href="#4장-프라이버시" class="table-of-contents__link toc-highlight">4장. 프라이버시</a></li><li><a href="#5장-솔직히-말하자면" class="table-of-contents__link toc-highlight">5장. 솔직히 말하자면</a></li><li><a href="#6장-돌아온-모두를-위한-평등" class="table-of-contents__link toc-highlight">6장. 돌아온 &#39;모두를 위한 평등&#39;</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tech/">테크</a></li><li class="footer__item"><a class="footer__link-item" href="/fintech/">핀테크</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/books/">책</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/mingyu-gu-25aa761b5/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 kooku's log, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>