<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-books/get-your-hands-dirty-on-clean-architecture/07" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">07 아키텍처 요소 테스트하기 | Kooku&#x27;s log</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kooku0.github.io/docs/books/get-your-hands-dirty-on-clean-architecture/07/"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="07 아키텍처 요소 테스트하기 | Kooku&#x27;s log"><meta data-rh="true" name="description" content="이번 장에서는 육각형 아키텍처에서의 테스트 전략에 대해 이야기한다."><meta data-rh="true" property="og:description" content="이번 장에서는 육각형 아키텍처에서의 테스트 전략에 대해 이야기한다."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kooku0.github.io/docs/books/get-your-hands-dirty-on-clean-architecture/07/"><link data-rh="true" rel="alternate" href="https://kooku0.github.io/docs/books/get-your-hands-dirty-on-clean-architecture/07/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://kooku0.github.io/docs/books/get-your-hands-dirty-on-clean-architecture/07/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"07 아키텍처 요소 테스트하기","item":"https://kooku0.github.io/docs/books/get-your-hands-dirty-on-clean-architecture/07"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kooku&#39;s log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kooku&#39;s log Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KVSM4B0KPY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KVSM4B0KPY",{})</script>



<link rel="alternate" type="application/rss+xml" href="/retrospect/rss.xml" title="Kooku&#39;s log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/retrospect/atom.xml" title="Kooku&#39;s log Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/journal/rss.xml" title="Kooku&#39;s log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/journal/atom.xml" title="Kooku&#39;s log Atom Feed"><link rel="stylesheet" href="/assets/css/styles.fee6da73.css">
<script src="/assets/js/runtime~main.029eb6d8.js" defer="defer"></script>
<script src="/assets/js/main.0388bff9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/favicon.ico"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_NOcl" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="메인" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="사이드바 펼치거나 접기" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="My Site Logo" class="themedComponent_ZEmY themedComponent--light_FtRR"><img src="/img/favicon.ico" alt="My Site Logo" class="themedComponent_ZEmY themedComponent--dark_Mxjv"></div><b class="navbar__title text--truncate">Kooku&#x27;s log</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/books/">Book</a><a class="navbar__item navbar__link" href="/journal/">Journal</a><a class="navbar__item navbar__link" href="/docs/smartfarm/">Smartfarm</a><a class="navbar__item navbar__link" href="/docs/stock/financial-statements/">Stock</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Mwx1"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_jase colorModeToggle_lYe3"><button class="clean-btn toggleButton_m9xI toggleButtonDisabled_SFpV" type="button" disabled="" title="system mode" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_oaMR lightToggleIcon_mm09"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_oaMR darkToggleIcon_WIli"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_oaMR systemToggleIcon_W5A2"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Jfr1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_zdZd"><div class="docsWrapper_iXki"><button aria-label="맨 위로 스크롤하기" class="clean-btn theme-back-to-top-button backToTopButton_qiO7" type="button"></button><div class="docRoot_l_EL"><aside class="theme-doc-sidebar-container docSidebarContainer_sBv0"><div class="sidebarViewport_Kcmj"><div class="sidebar_YrTP"><nav aria-label="문서 사이드바" class="menu thin-scrollbar menu_I_F4"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/books/">책 목록</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/books/clean-code/introduction/">테크</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/clean-code/introduction/">클린코드</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/object/introduction/">오브젝트</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/frameworkless-front-end-development/introduction/">프레임워크 없는 프론트엔드 개발</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/introduction/">만들면서 배우는 클린 아키텍처</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/introduction/">책 소개</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/01/">01 계층형 아키텍처의 문제는 무엇일까?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/02/">02 의존성 역전하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/03/">03 코드 구성하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/04/">04 유스케이스 구현하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/05/">05 웹 어댑터 구현하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/06/">06 영속성 어댑터 구현하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/07/">07 아키텍처 요소 테스트하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/08/">08 경계간 매핑하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/09/">09 애플리케이션 조립하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/10/">10 아키텍처 경계 강제하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/11/">11 의식적으로 지름길 사용하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/get-your-hands-dirty-on-clean-architecture/12/">12 아키텍처 스타일 결정하기</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/functional-programming-in-scala/introduction/">스칼라로 배우는 함수형 프로그래밍</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/effective-typescript/introduction/">이펙티브 타입스크립트</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/the-pragmatic-programmer/introduction/">실용주의 프로그래머</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/test-driven-development/introduction/">테스트 주도 개발</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/functional-programming-in-javascript/introduction/">함수형 자바스크립트</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/designing-for-performance/introduction/">디자이너를 위한 웹 성능 최적화 기법</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/grokking-simplicity/introduction/">쏙쏙 들어오는 함수형 코딩</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/books/unit-testing/introduction/">단위 테스트</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/books/atomic-habit/09/">자기계발</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/books/around-industries-in-40-days/introduction/">핀테크</a></div></li></ul></nav><button type="button" title="사이드바 숨기기" aria-label="사이드바 숨기기" class="button button--secondary button--outline collapseSidebarButton_WKCe"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_ewWl"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_HaE_"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Lo_8"><div class="docItemContainer_HX_5"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_jwLm" aria-label="탐색 경로"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="홈" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_A3Lb"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">테크</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">만들면서 배우는 클린 아키텍처</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">07 아키텍처 요소 테스트하기</span></li></ul></nav><div class="tocCollapsible_c4rR theme-doc-toc-mobile tocMobile_Wr91"><button type="button" class="clean-btn tocCollapsibleButton_l0Jz">이 페이지에서</button></div><div class="theme-doc-markdown markdown"><header><h1>07 아키텍처 요소 테스트하기</h1></header><p>이번 장에서는 육각형 아키텍처에서의 테스트 전략에 대해 이야기한다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="테스트-피라미드">테스트 피라미드<a href="#테스트-피라미드" class="hash-link" aria-label="테스트 피라미드에 대한 직접 링크" title="테스트 피라미드에 대한 직접 링크">​</a></h2>
<p><img decoding="async" loading="lazy" alt="img" src="/assets/images/7.1-052d9aa2f7f44ca0b7e5bb0d5e39a7de.jpeg" width="722" height="449" class="img_XIZS"></p>
<div class="theme-admonition theme-admonition-note admonition_Djjz alert alert--secondary"><div class="admonitionHeading_ImtD"><span class="admonitionIcon_WekS"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_AQtx"><p>테스트 피라미드에 따르면 비용이 많이 드는 테스트는 지양하고 비용이 적게 드는 테스트를 많이 만들어야 한다.</p></div></div>
<p>기본 전제는 만드는 비용이 적고, 유지보수하기 쉽고, 빨리 실행되고, 안정적인 작은 크기의 테스트들에 대해 높은 커버리지를 유지해야 한다는 것이다. 이 테스트는 하나의 &#x27;단위&#x27;(일반적으로 하나의 클래스)가 제대로 동작하는지 확인할 수 있는 단위 테스트들이다.</p>
<p>여러 개의 단위와 단위를 넘는 경계, 아키텍처 경계, 시스템 경계를 결합하는 테스트는 만드는 비용이 더 비싸지고, 실행이 더 느려지며 (기능 에러가 아닌 설정 에러로 인해) 깨지기 더 쉬워진다. 테스트 피라미드는 테스트가 비싸질수록 테스트의 커버리지 목표는 낮게 잡아야 한다는 것을 보여준다. 그렇지 않으면 새로운 기능을 만드는 것보다 테스트를 만드는 데 시간을 더 쓰게 되기 때문이다.</p>
<p>단위 테스트는 피라미드의 토대에 해당한다. 일반적으로 하나의 클래스를 인스턴스화하고 해당 클래스의 인터페이스를 통해 기능들을 테스트한다. 만약 테스트 중인 클래스가 다른 클래스에 의존한다면 의존되는 클래스들은 인스턴스화하지 않고 테스트하는 동안 필요한 작업들을 흉내 내는 목(mock)으로 대체한다.</p>
<p>피라미드의 다음 계층은 통합 테스트다. 이 테스트는 연결된 여러 유닛을 인스턴스화하고 시작점이 되는 클래스의 인터페이스로 데이터를 보낸 후 유닛들의 네트워크가 기대한대로 잘 동작하는지 검증한다. 이 책에서 정의한 통합 테스트에서는 두 계층 간의 경계를 걸쳐서 테스트할 수 있기 때문에 객체 네트워크가 완전하지 않거나 어떤 시점에는 목을 대상으로 수행해야 한다.</p>
<p>마지막으로 시스템 테스트는 애플리케이션을 구성하는 모든 객체 네트워크를 가동시켜 특정 유스케이스가 전 계층에서 잘 동작하는지 검증한다.</p>
<p>시스템 테스트 위에는 엔드투엔드 테스트층이 있을 수 있다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="단위-테스트로-도메인-엔티티-테스트하기">단위 테스트로 도메인 엔티티 테스트하기<a href="#단위-테스트로-도메인-엔티티-테스트하기" class="hash-link" aria-label="단위 테스트로 도메인 엔티티 테스트하기에 대한 직접 링크" title="단위 테스트로 도메인 엔티티 테스트하기에 대한 직접 링크">​</a></h2>
<p>Account 엔티티를 떠올려보자. Account의 상태는 과거 특정 시점의 계좌 잔고와 그 이후의 입출금 내역으로 구성돼 있다. withdraw() 메서드가 기대한 대로 동작하는지 검증해보자.</p>
<div class="language-java codeBlockContainer_Gd43 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_RBTH"><pre tabindex="0" class="prism-code language-java codeBlock_OKpF thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_jdxZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class AccountTest {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Test</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  void withdrawalSucceeds() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    AccountId accountId = new AccountId(1L);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Account account = defaultAccount()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      .withAccountId(accountId)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      .withBaselineBalance(Money.of(555L))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      .withActivityWindow(new ActivityWindow(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        defaultActivity()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .withTargetAccount(accountId)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .withMoney(Money.of(999L)).build(),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        defaultActivity()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .withTargetAccount(accountId)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .withMoney(Money.of(1L)).build()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      )).build();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    boolean success = account.withdraw(Money.of(555L), new AccountId(99L));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(success).isTrue();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(account.getActivityWindow().getActivities()).hasSize(3);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(account.calculateBalance()).isEqualTo(Money.of(1000L));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>위 코드는 특정 상태의 Account를 인스턴스화하고 withdraw() 메서드를 호출해서 출금을 성공했는지 검증하고, Account 객체의 상태에 대해 기대되는 부수효과들이 잘 일어났는지 확인하는 단위 테스트다.</p>
<p>이 테스트는 만들고 이해하는 것도 쉬운 편이고, 아주 빠르게 실행된다. 도메인 엔티티의 행동은 다른 클래스에 거의 의존하지 않기 때문에 다른 종류의 테스트는 필요하지 않다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="단위-테스트로-유스케이스-테스트하기">단위 테스트로 유스케이스 테스트하기<a href="#단위-테스트로-유스케이스-테스트하기" class="hash-link" aria-label="단위 테스트로 유스케이스 테스트하기에 대한 직접 링크" title="단위 테스트로 유스케이스 테스트하기에 대한 직접 링크">​</a></h2>
<p>SendMoneyService의 테스트를 살펴보자. SendMoney 유스케이스는 출금 계좌의 잔고가 다른 트랜잭션에 의해 변경되지 않도록 락을 건다. 출금 계좌에서 돈이 출금되고 나면 똑같이 입금 계좌에 락을 걸고 돈을 입금시킨다. 그러고 나서 두 계좌에서 모두 락을 해제한다.</p>
<div class="language-java codeBlockContainer_Gd43 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_RBTH"><pre tabindex="0" class="prism-code language-java codeBlock_OKpF thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_jdxZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class SendMoneyServiceTest {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  // ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Test</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  void transactionSucceeds() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Account sourceAccount = givenSourceAccount();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Account targetAccount = givenTargetAccount();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    givenWithdrawalWillSucceed(sourceAccount);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    givenDepositWillSucceed(targetAccount);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Money money = Money.of(500L);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    SendMoneyCommand command = new SendMoneyCommand(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      sourceAccount.getId(),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      targetAccount.getId(),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      money</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    boolean success = sendMoneyService.sendMoney(command);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(success).isTrue();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    AccountId sourceAccountId = sourceAccount.getId();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    AccountId targetAccountId = targetAccount.getId();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    then(accountLock).should().lockAccount(eq(sourceAccountId));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    then(sourceAccount).should().withdraw(eq(money), eq(targetAccountId));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    then(accountLock).should().releaseAccount(eq(sourceAccountId));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    then(accountLock).should().lockAccount(eq(targetAccountId));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    then(targetAccount).should().withdraw(eq(money), eq(sourceAccountId));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    then(accountLock).should().releaseAccount(eq(targetAccountId));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    thenAccountsHaveBeenUpdated(sourceAccountId, targetAccountId);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>테스트의 가독성을 높이기 위해 행동-주도 개발(behavior driven development)에서 일반적으로 사용되는 방식대로 given/when/then 섹션으로 나눴다.</p>
<p>코드에는 없지만 테스트는 Mockito 라이브러리를 이용해 given...() 메서드의 목 객체를 생성한다. Mockito는 목 객체에 대해 특정 메서드가 호출됐는지 검증할 수 있는 then() 메서드도 제공한다.</p>
<p>테스트 중인 유스케이스 서비스는 상태가 없기 때문에 <code>then</code> 섹션에서 특정 상태를 검증할 수 없다. 대신 테스트는 서비스가 (모킹된) 의존 대상의 특정 메서드와 상호작용했는지 여부를 검증한다. 이는 테스트가 코드의 <strong>행동</strong> 변경뿐만 아니라 코드의 <strong>구조</strong> 변경에도 취약해진다는 의미가 된다. 자연스럽게 코드가 리팩터링되면 테스트도 변경될 확률이 높아진다.</p>
<p>그렇기 때문에 테스트에서 어떤 상호작용을 검증하고 싶은지 신중하게 생각해야 한다. <strong>모든</strong> 동작을 검증하는 대신 중요한 핵심만 골라 집중해서 테스트하는 것이 좋다. 만약 모든 동작을 검증하는 대신 중요한 핵심만 골라 집중해서 테스트하는 것이 좋다. 모든 동작을 검증하려고 하면 클래스가 조금이라도 바뀔 때마다 테스트를 변경해야 한다. 이는 테스트의 가치를 떨어뜨리는 일이다.</p>
<p>단위 테스트이긴 하지만 의존성이 상호작용을 테스트하고 있기 때문에 통합 테스트에 가깝다. 그렇지만 목으로 작업하고 있고 실제 의존성을 관리해야 하는 것은 아니기 때문에 완전한 통합 테스트에 비해 만들고 유지보수하기가 쉽다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="통합-테스트로-웹-어댑터-테스트하기">통합 테스트로 웹 어댑터 테스트하기<a href="#통합-테스트로-웹-어댑터-테스트하기" class="hash-link" aria-label="통합 테스트로 웹 어댑터 테스트하기에 대한 직접 링크" title="통합 테스트로 웹 어댑터 테스트하기에 대한 직접 링크">​</a></h2>
<p>웹 어댑터는 HTTP를 통해 입력을 받고, 입력에 대한 유효성 검증을 하고, 유스케이스에서 사용할 수 있는 포맷으로 매핑하고, 유스케이스에 전달한다. 그리고 나서 유스케이스의 결과를 JSON으로 매핑하고 HTTP 응답을 통해 클라이언트에 반환했다.</p>
<p>웹 어댑터 테스트에서는 앞의 모든 단계들이 기대한 대로 동작하는지 검증해야 한다.</p>
<div class="language-java codeBlockContainer_Gd43 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_RBTH"><pre tabindex="0" class="prism-code language-java codeBlock_OKpF thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_jdxZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">@WebMvcTest(controllers = SendMoneyController.class)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class SendMoneyControllerTest {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Autowired</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  private MockMvc mockMvc;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @MockBean</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  private SendMoneyUseCase sendMoneyUseCase;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Test</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  void testSendMoney() throws Exception {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    mockMvc.perform(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      post(&quot;/accounts/send/{sourceAccountId}/{targetAccountId}/{amount}&quot;, 41L, 42L, 500).header(&quot;Content-Type&quot;, &quot;application/json&quot;))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ).andExpect(status().isOk());</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    then(sendMoneyUseCase).should().sendMoney(eq(new SendMoneyCommand(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      new AccountId(41L),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      new AccountId(42L),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      Money.of(500L)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    )));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>위 코드는 스프링 부트 프레임워크에서 SendMoneyController라는 웹 컨트롤러를 테스트하는 표준적인 통합 테스트 방법이다. testSendMoney() 메서드에서는 입력 객체를 만들고 목 HTTP 요청을 웹 컨트롤러에 보낸다. 요청 바디는 JSON 문자열의 형태로 입력 객체를 포함한다.</p>
<p>isOk() 메서드로 HTTP 응답 상태가 200임을 검증하고, 모킹한 유스케이스가 잘 호출됐는지 검증한다.</p>
<p>MockMvc 객체를 이용해 모킹했기 때문에 실제로 HTTP 프로토콜을 통해 테스트한 것은 아니다. 프레임워크가 HTTP 프로토콜에 맞게 모든 것을 적절히 잘 변환했다고 믿는 것이다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="통합-테스트로-영속성-어댑터-테스트하기">통합 테스트로 영속성 어댑터 테스트하기<a href="#통합-테스트로-영속성-어댑터-테스트하기" class="hash-link" aria-label="통합 테스트로 영속성 어댑터 테스트하기에 대한 직접 링크" title="통합 테스트로 영속성 어댑터 테스트하기에 대한 직접 링크">​</a></h2>
<p>영속성 어댑터의 테스트에는 단위 테스트보다는 통합 테스트를 적용하는 것이 합리적이다. 단순히 어댑터의 로직만 검증하고 싶은 게 아니라 데이터베이스 매핑도 검증하고 싶기 때문이다.</p>
<div class="language-java codeBlockContainer_Gd43 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_RBTH"><pre tabindex="0" class="prism-code language-java codeBlock_OKpF thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_jdxZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">@DataJpaTest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">@Import({ AccountPersistenceAdapter.class, AccountMapper.class })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class AccountPersistenceAdapterTest {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Autowired</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  private AccountPersistenceAdapter adapterUnderTest;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Autowired</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  private ActivityRepository activityRepository;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Test</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Sql(&quot;AccountPersistenceAdapterTest.sql&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  void loadsAccount() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Account account = adapter.loadAccount(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      new AccountId(1L),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      LocalDateTime.of(2018, 8, 10, 0, 0)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(account.getActivityWindow().getActivities()).hasSize(2);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(account.calculateBalance().isEqualTo(Money.of(500));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  @Test</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  void updatesActivities() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Account account = defaultAccount()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      .withBaselineBalance(Money.of(555L))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      .withActivityWindow(new ActivityWindow(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        defaultActivity()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .withId(null)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .withMoney(Money.of(1L)).build()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      )).build();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    adapter.updateActivities(account);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(activityRepository.count()).isEqualTo(1);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ActivityJpaEntity savedActivity = activityRepository.findAll().get(0);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    assertThat(savedActivity.getAmount()).isEqualTo(1L);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>loadAccount() 메서드에 대한 테스트에서는 SQL 스크립트를 이용해 데이터베이스를 특정 상태로 만든다. 그런 다음, 어댑터 API를 이용해 계좌를 가져온 후 SQL 스크립트에서 설정한 상태값을 가지고 있는지 검증한다.</p>
<p>updateActivities() 메서드에 대한 테스트는 반대로 동작한다. 새로운 계좌 활동을 가진 Account 객체를 만들어서 저장하기 위해 어댑터로 전달한다. 그러고 나서 ActivityRepository의 API를 이용해 이 활동이 데이터베이스에 잘 저장됐는지 확인한다.</p>
<p>이 테스트에서는 데이터베이스를 모킹하지 않았다는 점이 중요하다. 테스트가 실제로 데이터베이스에 접근한다. 데이터베이스를 모킹했더라도 테스트는 여전히 같은 코드 라인 수만큼 커버해서 똑같이 높은 커버리지를 보여줬을 것이다. 하지만 높은 커버리지도 불구하고 여전히 실제 데이터베이스와 연동했을 때 SQL 구문의 오류나 데이터베이스 테이블과 자바 객체 간의 매핑 에러 등으로 문제가 생길 확률이 높아진다.</p>
<p>이러한 이유로 영속성 어댑터 테스트는 실제 데이터베이스를 대상으로 진행해야 한다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="시스템-테스트로-주요-경로-테스트하기">시스템 테스트로 주요 경로 테스트하기<a href="#시스템-테스트로-주요-경로-테스트하기" class="hash-link" aria-label="시스템 테스트로 주요 경로 테스트하기에 대한 직접 링크" title="시스템 테스트로 주요 경로 테스트하기에 대한 직접 링크">​</a></h2>
<p>피라미드의 최상단에 있는 시스템 테스트는 전체 어플리케이션을 띄우고 API를 통해 요청을 보내고, 모든 계층이 조화롭게 잘 동작하는지 검증한다.</p>
<p>시스템 테스트는 여러 개의 유스케이스를 결합해서 시나리오를 만들 때 더 빛이 난다. 각 시나리오는 사용자가 애플리케이션을 사용하면서 거쳐갈 특정 경로를 의미한다. 시스템 테스트를 통해 중요한 시나리오들이 커버된다면 최신 변경사항들이 애플리케이션을 망가뜨리지 않았음을 가정할 수 있고, 배포될 준비가 됐다는 확신을 가질 수 있다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="얼마만큼의-테스트가-충분할까">얼마만큼의 테스트가 충분할까?<a href="#얼마만큼의-테스트가-충분할까" class="hash-link" aria-label="얼마만큼의 테스트가 충분할까?에 대한 직접 링크" title="얼마만큼의 테스트가 충분할까?에 대한 직접 링크">​</a></h2>
<p>라인 커버리지는 테스트 성공을 측정하는 데 있어서는 잘못된 지표다. 코드의 중요한 부분이 전혀 커버되지 않을 수 있기 때문에 100%를 제외한 어떤 목표도 완전히 무의미하다. 그리고 심지어 100%라 하더라도 버그가 잘 잡혔는지 확신할 수 없다.</p>
<p>나는 얼마나 마음 편하게 소프트웨어를 배포할 수 있느냐를 테스트의 성공 기준으로 삼으면 된다고 생각한다. 테스트를 실행한 후에 소프트웨어를 배포해도 될 만큼 테스트를 신뢰한다면 그것으로 된 것이다.</p>
<p>각각의 프로덕션 버그에 대해서 &quot;테스트가 이 버그를 왜 잡지 못했을까?&quot;를 생각하고 이에 대한 답변을 기록하고, 이 케이스를 커버할 수 있는 테스트를 추가해야 한다. 시간이 지나면 이 작업들이 배포할 때 마음을 편하게 해줄 것이고, 남겨둔 기록은 시간이 지날수록 상황이 개선되고 있음을 증명해줄 것이다.</p>
<p>다음은 육각형 아키텍처에서 사용하는 전략이다.</p>
<ul>
<li>도메인 엔티티를 구현할 때는 단위 테스트로 커버하자</li>
<li>유스케이스를 구현할 때는 단위 테스트로 커버하자</li>
<li>어댑터를 구현할 때는 통합 테스트로 커버하자</li>
<li>사용자가 취할 수 있는 중요 애플리케이션 경로는 시스템 테스트로 커버하자</li>
</ul>
<p>&#x27;구현할 때는&#x27;이라는 문구에 주목하자. 만약 테스트가 기능 개발 후가 아닌 개발 중에 이뤄진다면 하기 싫은 귀찮은 작업이 아니라 개발 도구로 느껴질 것이다.</p>
<p>하지만 새로운 필드를 추가할 때마다 테스트를 고치는 데 한 시간을 써야 한다면 뭔가 잘 못된 것이다. 테스트가 코드의 구조적 변경에 너무 취약할 것이므로 어떻게 개선할지 살펴봐야 한다. 리팩터링할 때마다 테스트 코드도 변경해야 한다면 테스트는 테스트로서의 가치를 잃는다.</p>
<h2 class="anchor anchorWithStickyNavbar_tzX7" id="유지보수-가능한-소프트웨어를-만드는-데-어떻게-도움이-될까">유지보수 가능한 소프트웨어를 만드는 데 어떻게 도움이 될까?<a href="#유지보수-가능한-소프트웨어를-만드는-데-어떻게-도움이-될까" class="hash-link" aria-label="유지보수 가능한 소프트웨어를 만드는 데 어떻게 도움이 될까?에 대한 직접 링크" title="유지보수 가능한 소프트웨어를 만드는 데 어떻게 도움이 될까?에 대한 직접 링크">​</a></h2>
<p><strong>육각형 아키텍처</strong>는 도메인 로직과 바깥으로 향한 어댑터를 깔끔하게 분리한다. 덕분에 핵심 도메인 로직은 단위 테스트로, 어댑터는 통합 테스트로 처리하는 명확한 테스트 전략을 정의할 수 있다.</p>
<p>입출력 포트는 테스트에서 아주 뚜렷한 모킹 지점이 된다. 각 포트에 대해 모킹할지, 실제 구현을 이용할지 선택할 수 있다. 만약 포트가 아주 작고 핵심만 담고 있다면 모킹하는 것이 아주 쉬울 것이다.</p>
<p>모킹하는 것이 너무 버거워지거나 코드의 특정 부분을 커버하기 위해 어떤 종류의 테스트를 써야 할지 모르겠다면 이는 경고 신호다. 이런 측면에서 테스트는 아키텍처의 문제에 대해 경고하고 유지보수 가능한 코드를 만들기 위해 인도하는 역할을 한다.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kooku0/kooku0.github.io/edit/main/docs/books/get-your-hands-dirty-on-clean-architecture/07.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Wq7p" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_BRsH"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="문서 페이지"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/books/get-your-hands-dirty-on-clean-architecture/06/"><div class="pagination-nav__sublabel">이전</div><div class="pagination-nav__label">06 영속성 어댑터 구현하기</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/books/get-your-hands-dirty-on-clean-architecture/08/"><div class="pagination-nav__sublabel">다음</div><div class="pagination-nav__label">08 경계간 매핑하기</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_C7Qc thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#테스트-피라미드" class="table-of-contents__link toc-highlight">테스트 피라미드</a></li><li><a href="#단위-테스트로-도메인-엔티티-테스트하기" class="table-of-contents__link toc-highlight">단위 테스트로 도메인 엔티티 테스트하기</a></li><li><a href="#단위-테스트로-유스케이스-테스트하기" class="table-of-contents__link toc-highlight">단위 테스트로 유스케이스 테스트하기</a></li><li><a href="#통합-테스트로-웹-어댑터-테스트하기" class="table-of-contents__link toc-highlight">통합 테스트로 웹 어댑터 테스트하기</a></li><li><a href="#통합-테스트로-영속성-어댑터-테스트하기" class="table-of-contents__link toc-highlight">통합 테스트로 영속성 어댑터 테스트하기</a></li><li><a href="#시스템-테스트로-주요-경로-테스트하기" class="table-of-contents__link toc-highlight">시스템 테스트로 주요 경로 테스트하기</a></li><li><a href="#얼마만큼의-테스트가-충분할까" class="table-of-contents__link toc-highlight">얼마만큼의 테스트가 충분할까?</a></li><li><a href="#유지보수-가능한-소프트웨어를-만드는-데-어떻게-도움이-될까" class="table-of-contents__link toc-highlight">유지보수 가능한 소프트웨어를 만드는 데 어떻게 도움이 될까?</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">블로그</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/books/">책</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Mwx1"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/mingyu-gu-25aa761b5/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Mwx1"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 kooku's log, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>