"use strict";(self.webpackChunkkooku_log=self.webpackChunkkooku_log||[]).push([[7166],{57166:(e,t,n)=>{n.d(t,{T:()=>w});var r=n(5482),o=n(36672);const a=()=>"undefined"==typeof window&&(console.error("ChannelIO APIs are only executable on browser."),!0);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,(0,r.__spreadArray)(["[react-channel-plugin]"],(0,r.__read)(e),!1))}function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&console.debug.apply(console,(0,r.__spreadArray)(["\u2699\ufe0f [react-channel-plugin - debug]"],(0,r.__read)(t),!1))}var c=function(e){var t=(0,o.useRef)(e);return(0,o.useEffect)((function(){t.current=e}),[e]),t},s=n(93212),l=n.n(s);var f=Object.freeze(["boot","shutdown","showMessenger","hideMessenger","openChat","openWorkflow","track","onShowMessenger","onHideMessenger","onBadgeChanged","onChatCreated","onFollowUpChanged","onUrlClicked","clearCallbacks","updateUser","addTags","removeTags","setPage","resetPage","showChannelButton","hideChannelButton","setAppearance"]),d=(Object.freeze(f.filter((function(e){return!e.startsWith("on")}))),Object.freeze(f.filter((function(e){return e.startsWith("on")})))),g=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"undefined"!=typeof window&&("function"==typeof window.ChannelIO?window.ChannelIO.apply(window,(0,r.__spreadArray)([e],(0,r.__read)(t),!1)):u("ChannelIO instance is not initalized yet."))},h=(0,o.createContext)(null);Object.freeze((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(d),!1),["onBoot"],!1));function p(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];document.dispatchEvent(new CustomEvent("react-channelio-evt",{detail:{name:e,args:t}}))}}var v="data-channel-plugin",b="launcher",w=function(e){var t,n,s,f=e.children,w=e.autoBoot,y=void 0!==w&&w,_=e.autoBootTimeout,m=void 0===_?1e3:_,C=e.rebootOnOptionChanged,O=void 0===C||C,k=e.useCustomLauncherSelectorTweak,E=void 0===k||k,B=e.verbose,A=void 0!==B&&B,S=e.onBoot,j=(0,r.__rest)(e,["children","autoBoot","autoBootTimeout","rebootOnOptionChanged","useCustomLauncherSelectorTweak","verbose","onBoot"]),T=c(j),L=c(S),I=(0,r.__read)(o.useState(!1),2),M=I[0],z=I[1],P=(0,o.useCallback)((function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,new Promise((function(e,t){try{i(A,"Booting plugin..."),i(A,"boot options =>",T.current),i(A,"Registering callback events..."),g("clearCallbacks"),setTimeout((function(){d.forEach((function(e){g(e,p(e))}))})),g("boot",T.current,(function(n,r){if(p("onBoot")(n,r),"function"==typeof L.current&&L.current(n,r),n)return u("Error occurred while boot plugin.",n),z(!1),void t(n);var o={};(null==r?void 0:r.language)!==T.current.language&&(o.language=T.current.language),null===T.current.profile&&(o.profile=null),g("updateUser",o,(function(e,t){e?u("Fail to reset user information of plugin."):i(A,"User updated after booting",t)})),i(A,"Booted"),setTimeout((function(){z(!0),e(r)}))}))}catch(n){t(n)}}))]}))}))}),[A,T,L]),x=(0,o.useCallback)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i(A,"Shuting down plugin..."),g("clearCallbacks"),g.apply(void 0,(0,r.__spreadArray)(["shutdown"],(0,r.__read)(e),!1)),z(!1)}),[A]);return(0,o.useEffect)((function(){return i(A,"Bootstraping plugin...","(Set verbose flag `false`, to remove these debugging logs)"),(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),a()||function(){var e=window;if(!e.ChannelIO){var t=function(){var e;null===(e=t.c)||void 0===e||e.call(t,arguments)};t.q=[],t.c=function(e){var n;null===(n=t.q)||void 0===n||n.push(e)},e.ChannelIO=t,"complete"===document.readyState?n():(e.addEventListener("DOMContentLoaded",n),e.addEventListener("load",n))}function n(){if(!e.ChannelIOInitialized){e.ChannelIOInitialized=!0;var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://cdn.channel.io/plugin/ch-plugin-web.js";var n=document.getElementsByTagName("script")[0];n.parentNode&&n.parentNode.insertBefore(t,n)}}}(),i(A,"Auto boot flag set as",y),y?[4,new Promise((function(e){return setTimeout(e,m)}))]:[3,3];case 1:return e.sent(),i(A,"Auto Booting..."),[4,P().catch((function(){}))];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return u("Error occurred at plugin boot processing on first mount.",e.sent()),[3,5];case 5:return[2]}}))})),function(){x()}}),[]),t=function(){M&&O&&(i(A,"Rebooting since option has been changed..."),P().catch((function(){})))},n=[j],(s=(0,o.useRef)(void 0)).current&&l()(n,s.current)||(s.current=n),(0,o.useEffect)(t,s.current),(0,o.useEffect)((function(){var e=j.customLauncherSelector;if(E&&e){var t=new MutationObserver((function(t){t.filter((function(e){return"childList"===e.type})).filter((function(e){return e.target instanceof HTMLElement})).map((function(t){return t.target.querySelectorAll(e)})).forEach((function(e){return Array.from(e).filter((function(e){return e instanceof HTMLElement})).forEach((function(e){var t=e;t.getAttribute(v)!==b&&(t.setAttribute(v,b),t.addEventListener("click",(function(){return g("showMessenger")}),!1))}))}))}));return t.observe(document.body,{attributes:!1,childList:!0,subtree:!0}),function(){t.disconnect()}}}),[j.customLauncherSelector,E]),o.createElement(h.Provider,{children:f,value:{isBooted:M,boot:P,shutdown:x}})}},93212:e=>{e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,o,a;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!==o--;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!==o--;)if(!Object.prototype.hasOwnProperty.call(n,a[o]))return!1;for(o=r;0!==o--;){var u=a[o];if(!e(t[u],n[u]))return!1}return!0}return t!=t&&n!=n}}}]);