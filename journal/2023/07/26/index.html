<!doctype html>
<html lang="ko" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-journal" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-rc.0">
<title data-rh="true">2023.07.26 | Kooku&#x27;s log</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kooku0.github.io/journal/2023/07/26/"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="2023.07.26 | Kooku&#x27;s log"><meta data-rh="true" name="description" content="0. 일상"><meta data-rh="true" property="og:description" content="0. 일상"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-07-26T00:00:00.000Z"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kooku0.github.io/journal/2023/07/26/"><link data-rh="true" rel="alternate" href="https://kooku0.github.io/journal/2023/07/26/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://kooku0.github.io/journal/2023/07/26/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kooku&#39;s log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kooku&#39;s log Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KVSM4B0KPY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KVSM4B0KPY",{})</script>


<link rel="alternate" type="application/rss+xml" href="/retrospect/rss.xml" title="Kooku&#39;s log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/retrospect/atom.xml" title="Kooku&#39;s log Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/journal/rss.xml" title="Kooku&#39;s log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/journal/atom.xml" title="Kooku&#39;s log Atom Feed"><link rel="stylesheet" href="/assets/css/styles.f2801058.css">
<script src="/assets/js/runtime~main.98a63172.js" defer="defer"></script>
<script src="/assets/js/main.ebb4d742.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_t12J" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="My Site Logo" class="themedComponent_Amui themedComponent--light_AlQr"><img src="/img/favicon.ico" alt="My Site Logo" class="themedComponent_Amui themedComponent--dark_tPex"></div><b class="navbar__title text--truncate">Kooku&#x27;s log</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/books/">Book</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/journal/">Journal</a><a class="navbar__item navbar__link" href="/docs/smart-farm/">Smart Farm</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CFuJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_zrlu colorModeToggle_dHEF"><button class="clean-btn toggleButton_kZcT toggleButtonDisabled_yHSB" type="button" disabled="" title="어두운 모드와 밝은 모드 전환하기 (현재 어두운 모드)" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 어두운 모드)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_iOKC"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_tvvw"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_U4MF"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_rHI0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_qw5u thin-scrollbar" aria-label="최근 블로그 문서 둘러보기"><div class="sidebarItemTitle_ZGwb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_RPB8 clean-list"><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/10/22/">2023.10.22</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/10/18/">2023.10.18</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/10/15/">2023.10.15</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/10/10/">2023.10.10</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/09/27/">2023.09.27</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/09/06/">2023.09.06</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/09/05/">2023.09.05</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/08/29/">2023.08.29</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/08/20/">2023.08.20</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/08/13/">2023.08.13</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/30/">2023.07.30</a></li><li class="sidebarItem_CBlA"><a aria-current="page" class="sidebarItemLink_ylmG sidebarItemLinkActive_PtsP" href="/journal/2023/07/26/">2023.07.26</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/22/">2023.07.22</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/20/">2023.07.20</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/18/">2023.07.18</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/16/">2023.07.16</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/15/">2023.07.15</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/12/">2023.07.12</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/11/">2023.07.11</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/09/">2023.07.09</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/08/">2023.07.08</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/05/">2023.07.06</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/07/02/">2023.07.02</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/28/">2023.06.28</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/25/">2023.06.25</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/24/">2023.06.24</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/19/">2023.06.19</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/18/">2023.06.18</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/17/">2023.06.17</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/14/">2023.06.14</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/13/">2023.06.13</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/12/">2023.06.12</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/09/">2023.06.09</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/08/">2023.06.08</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/07/">2023.06.07</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/06/">2023.06.06</a></li><li class="sidebarItem_CBlA"><a class="sidebarItemLink_ylmG" href="/journal/2023/06/05/">2023.06.05</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="0. 일상"><header><h1 class="title_wV4o" itemprop="headline">2023.07.26</h1><div class="container_JFeK margin-vert--md"><time datetime="2023-07-26T00:00:00.000Z" itemprop="datePublished">2023년 7월 26일</time> · <!-- -->약 14분</div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_H2Uu" id="0-일상">0. 일상<a href="#0-일상" class="hash-link" aria-label="0. 일상에 대한 직접 링크" title="0. 일상에 대한 직접 링크">​</a></h2>
<ul>
<li>당근에 온지 1주년이 되었다. 시간 엄청 빠르다. 1주년 회고도 써야겠다.</li>
<li>&quot;아주 작은 습관의 힘&quot; 책을 읽고 있는데 그렇게 많이 도움이 되지는 않는다. 하지만 끝까지 읽어보려고 노력중</li>
<li>오늘 오후에 문화의 날 활동으로 레드와인 테이스 팅을 한다. 7시에 와인수업도 있어서 오늘은 와인데이</li>
</ul>
<img src="/assets/images/daangn_1-02ddec0697cd49e0ae4ae0a79fbe03c2.jpg" width="300">
<h2 class="anchor anchorWithStickyNavbar_H2Uu" id="1-nextjs-dockerfile">1. NextJs Dockerfile<a href="#1-nextjs-dockerfile" class="hash-link" aria-label="1. NextJs Dockerfile에 대한 직접 링크" title="1. NextJs Dockerfile에 대한 직접 링크">​</a></h2>
<p>인터넷에 올라오는 것들은 node_modules 사용하는게 대부분이라 yarn berry 사용하는 버전으로 만든거 기록용으로 저장.
누군가는 쓰겠지...</p>
<p>nextConfig의 output에 &quot;standalone&quot; 설정하는거 잊지말자</p>
<blockquote>
<p>standalone에 대한 설명은 여기서: <a href="https://nextjs.org/docs/pages/api-reference/next-config-js/output#automatically-copying-traced-files" target="_blank" rel="noopener noreferrer">https://nextjs.org/docs/pages/api-reference/next-config-js/output#automatically-copying-traced-files</a></p>
</blockquote>
<p>참고: <a href="https://github.com/vercel/next.js/blob/canary/examples/with-docker/Dockerfile" target="_blank" rel="noopener noreferrer">https://github.com/vercel/next.js/blob/canary/examples/with-docker/Dockerfile</a></p>
<div class="language-docker codeBlockContainer_izg7 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_moPJ"><pre tabindex="0" class="prism-code language-docker codeBlock_w9zt thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_opl_"><span class="token-line" style="color:#9CDCFE"><span class="token plain">FROM node:18-alpine AS base</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Install dependencies only when needed</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FROM base AS deps</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RUN apk add --no-cache libc6-compat</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Install dependencies based on the preferred package manager</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY package.json ./</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY yarn.lock ./</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY .pnp.cjs ./</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY .pnp.loader.mjs ./</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY .yarnrc.yml ./</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY .yarn ./.yarn</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RUN yarn install --immutable</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Rebuild the source code only when needed</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FROM base AS builder</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY --from=deps /app/.yarn ./.yarn</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY --from=deps /app/.pnp.cjs ./pnp.cjs</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY . .</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Next.js collects completely anonymous telemetry data about general usage.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Learn more here: https://nextjs.org/telemetry</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Uncomment the following line in case you want to disable telemetry during the build.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># ENV NEXT_TELEMETRY_DISABLED 1</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RUN yarn build</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Production image, copy all the files and run next</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FROM base AS runner</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ENV NODE_ENV production</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RUN addgroup --system --gid 1001 nodejs</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RUN adduser --system --uid 1001 nextjs</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY --from=builder /app/public ./public</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Automatically leverage output traces to reduce image size</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># https://nextjs.org/docs/advanced-features/output-file-tracing</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY --from=builder --chown=nextjs:nodejs /app/.pnp.cjs ./</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RUN rm -rf ./.yarn/cache</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">COPY --from=builder --chown=nextjs:nodejs /app/.yarn ./.yarn/</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">USER nextjs</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">EXPOSE 3000</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ENV PORT 3000</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># CMD [&quot;node&quot;, &quot;server.js&quot;]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">CMD [&quot;node&quot;, &quot;-r&quot;, &quot;./.pnp.cjs&quot;, &quot;server.js&quot;]</span><br></span></code></pre><div class="buttonGroup_UnaD"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_kuWh" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_tSTY"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_pknt"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_H2Uu" id="2-jest-coverage-comment">2. Jest Coverage Comment<a href="#2-jest-coverage-comment" class="hash-link" aria-label="2. Jest Coverage Comment에 대한 직접 링크" title="2. Jest Coverage Comment에 대한 직접 링크">​</a></h2>
<p>ci 단계에서 unit test coverage 측정할 때 codecov actions를 사용하는 경우가 많은데 그렇게 되면 내부 코드가 codecov 로 전송된다는 매우 큰 리스크가 있다. 이에 괜찮은 새로운 actions를 찾아 공유한다.</p>
<p>바로 요것이다. <a href="https://github.com/marketplace/actions/jest-coverage-comment" target="_blank" rel="noopener noreferrer">https://github.com/marketplace/actions/jest-coverage-comment</a></p>
<p>comment도 이쁘게 잘 달아준다.</p>
<h3 class="anchor anchorWithStickyNavbar_H2Uu" id="step-1-필요-패키지를-설치한다">step 1) 필요 패키지를 설치한다.<a href="#step-1-필요-패키지를-설치한다" class="hash-link" aria-label="step 1) 필요 패키지를 설치한다.에 대한 직접 링크" title="step 1) 필요 패키지를 설치한다.에 대한 직접 링크">​</a></h3>
<div class="language-shell codeBlockContainer_izg7 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_moPJ"><pre tabindex="0" class="prism-code language-shell codeBlock_w9zt thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_opl_"><span class="token-line" style="color:#9CDCFE"><span class="token plain">yarn add -D jest-junit</span><br></span></code></pre><div class="buttonGroup_UnaD"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_kuWh" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_tSTY"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_pknt"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_H2Uu" id="step-2-ci용-jestconfig-파일을-만든다">step 2) ci용 jest.config 파일을 만든다.<a href="#step-2-ci용-jestconfig-파일을-만든다" class="hash-link" aria-label="step 2) ci용 jest.config 파일을 만든다.에 대한 직접 링크" title="step 2) ci용 jest.config 파일을 만든다.에 대한 직접 링크">​</a></h3>
<p>ci 스크립트에서 jest cli 를 활용하 는 방법도 있지만 이게 훨씬 깔끔하다.</p>
<div class="language-ts codeBlockContainer_izg7 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_cz_2">jest.ci-config.ts</div><div class="codeBlockContent_moPJ"><pre tabindex="0" class="prism-code language-ts codeBlock_w9zt thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_opl_"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> Config </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jest&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> defaultConfig </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;./jest.config&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> config</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Config </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain">defaultConfig</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  coverageReporters</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;json-summary&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;text&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  reporters</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;default&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jest-junit&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        outputDirectory</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;./coverage&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_UnaD"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_kuWh" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_tSTY"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_pknt"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-yaml codeBlockContainer_izg7 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_cz_2">coverage.yml</div><div class="codeBlockContent_moPJ"><pre tabindex="0" class="prism-code language-yaml codeBlock_w9zt thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_opl_"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Unit Test Coverage</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">pull_request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">CACHED_DEPENDENCY_PATHS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> github.workspace </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">/.yarn/unplugged</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> secrets.GITHUB_TOKEN </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">DEFAULT_NODE_VERSION</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;16.16.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">coverage</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">hosted</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> actions/checkout@v3</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Set up Node</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">node@v2</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">node-version</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> env.DEFAULT_NODE_VERSION </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Install dependencies</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> yarn install </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">immutable</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Check Unit Test Coverage</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token scalar string" style="color:rgb(206, 145, 120)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">          mkdir -p coverage</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">          yarn test:unit --coverage --config=jest.ci-config.ts | tee ./coverage/coverage.txt &amp;&amp; exit ${PIPESTATUS[0]}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Jest Coverage Comment</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> coverageComment</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> MishaKav/jest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">coverage</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">comment@main</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">coverage-summary-path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ./coverage/coverage</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">summary.json</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Test Coverage</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">summary-title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Coverage Report</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">badge-title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Coverage</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">hide-comment</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">create-new-comment</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">hide-summary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">junitxml-title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Test Suites Summary</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">junitxml-path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ./coverage/junit.xml</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">coverage-title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Coverage</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">coverage-path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ./coverage/coverage.txt</span><br></span></code></pre><div class="buttonGroup_UnaD"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_kuWh" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_tSTY"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_pknt"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>만약 가져다 사용하는 사람이 있다면 runs-on은 아마 바꿔야할 듯하다. 나는 github enterprise로 self-host를 띄우기에 저렇게 설정하였다.</p>
<p><code>Check Unit Test Coverage</code> step을 보면 <code>mkdir -p coverage</code> 는 tee command가 폴더가 없으면 파일을 만들지않기에 미리 만들어주는 것이다. <code>tee ./coverage/coverage.txt</code> 는 coverage script 돌고 나오는 마지막 summary table을 <code>coverage.txt</code> 파일에   입력시키는 명령어다.</p>
<h2 class="anchor anchorWithStickyNavbar_H2Uu" id="3-아주-작은-습관의-힘">3. 아주 작은 습관의 힘<a href="#3-아주-작은-습관의-힘" class="hash-link" aria-label="3. 아주 작은 습관의 힘에 대한 직접 링크" title="3. 아주 작은 습관의 힘에 대한 직접 링크">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_zbkM alert alert--secondary"><div class="admonitionHeading_ZYze"><span class="admonitionIcon_Lqel"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>목표 따윈 쓰레기통에 던져버리기</div><div class="admonitionContent_Iunh"><p>흔히 원하는 것을 얻으려면 구체적으로 실행 가능한 목표를 세워야 한다고 말한다.</p><p>나 역시 습관에 대해 오랫동안 이런 관점에서 접근했다. 습관 하나하나는 곧 도달해야 할 구체적인 목표였다. 하지만 그런 목표들 중에서 성공한 것은 극히 일부였고 대부분 실패했다. 나는 내가 얻어낸 결과들이 처음에 세웠던 목표와는 거의 관계가 없고, 사실 모든 것은 시스템에 달려 있다는 것을 깨달았다.</p><p>시스템과 목표의 차이는 무엇일까? 목표는 우리가 얻어내고자 하는 결과이며, 시스템은 그 결과로 이끄는 과정이다.</p><ul>
<li>감독의 목표는 챔피언십을 획득하는 것이다. 그렇다면 시스템은 선수들을 선발하는 방식, 코치들을 다루는 방식, 실행하는 방식이다.</li>
<li>기업가의 목표는 수백만 달러짜리 사업을 세우는 것이다. 그렇다면 시스템은 제품이나 서비스에 대한 아이디어를 테스트하는 법, 직원을 고용하는 법이다.</li>
<li>악기 연주자의 목표는 새로운 곡을 연주하는 것이다. 그렇다면 시스템은 &#x27;몇 번 연습할 것인가, 어떻게 틀을 깨고 다른 방식으로 연주할 것인가, 배운 내용을 어떻게 나만의 것으로 소화할 것인가&#x27;가 된다.</li>
</ul><p>이제 흥미로운 질문을 해보자. 목표를 완전히 무시하고 오직 시스템에만 집중한다면 그래도 성공할까? 나는 &#x27;그렇다&#x27;고 생각한다. 어떤 스포츠든 목표는 최고의 점수를 달성하는 것이다. 하지만 그렇다고 해서 경기 내내 점수판만 응시하는 건 말도 안되는 짓이다. 실제로 승리할 유일한 방법은 매일 더 나아지는 것뿐이다.</p><p>더 나은 결과를 내고 싶다면 목표를 세우는 일은 잊어라. 대신 시스템에 집중하라. 목표가 무용지물이라는 말은 아니다. 목표는 방향을 설정하는 데 필요하며 시스템은 과정을 제대로 해나가는 데 필요하다. 그러나 목표를 생각하느라 너무 많은 시간을 들이고 시스템을 고안하는 데는 시간을 투자하지 않을 때 문제가 발생한다.</p><h3 class="anchor anchorWithStickyNavbar_H2Uu" id="문제-1-성공한-사람도-성공하지-못한-사람도-목표는-같다">문제 1. 성공한 사람도, 성공하지 못한 사람도 목표는 같다.<a href="#문제-1-성공한-사람도-성공하지-못한-사람도-목표는-같다" class="hash-link" aria-label="문제 1. 성공한 사람도, 성공하지 못한 사람도 목표는 같다.에 대한 직접 링크" title="문제 1. 성공한 사람도, 성공하지 못한 사람도 목표는 같다.에 대한 직접 링크">​</a></h3><p>올림픽에 출전한 선수 모두가 금메달을 원한다. 입사 지원자 모두가 구직을 바란다. 성공한 사람도, 성공하지 못한 사람도 목표는 같다. 목표는 승자와 패자를 가르는 차이가 될 수 없다.</p><p>목표는 늘 거기에 있다. 결과에 차이가 생긴건 지속적으로 작은 개선들을 만들어내는 시스템을 시행한 것, 그뿐이였다.</p><h3 class="anchor anchorWithStickyNavbar_H2Uu" id="문제-2-목표-달성은-일시적-변화일-뿐이다">문제 2. 목표 달성은 일시적 변화일 뿐이다.<a href="#문제-2-목표-달성은-일시적-변화일-뿐이다" class="hash-link" aria-label="문제 2. 목표 달성은 일시적 변화일 뿐이다.에 대한 직접 링크" title="문제 2. 목표 달성은 일시적 변화일 뿐이다.에 대한 직접 링크">​</a></h3><p>지저분한 방이 있다고 생각해보라. 방을 치우기로 목표를 세운다. 그리고 당장 청소하는 데 필요한 에너지를 끌어올려 방을 치웠다. 하지만 대충대충 청소하거나 뭐든 잘 버리지 못하는 사람이라면 방은 또 지저분해질 것이다. 계속 같은 결과가 나타난다는 것은 이런 결과의 배경이 된 시스템을 바꾸지 못했기 때문이다. 원인을 다루지 않고 증상만을 치유한 것이다.</p><p>목표를 달성하는 것은 우리 인생의 &#x27;한순간&#x27;을 변화시킬 뿐이다. 이는 &#x27;개선&#x27;과는 다르다. 우리는 결과를 바꿔야 한다고 생각하지만 사실 그 결과는 문제가 아니다. 진짜로 해야 할 일은 결과를 유발하는 시스템을 바꾸는 것이다. 결과 수준에서 문제를 해결하려고 하면 이는 임시방편일 뿐이다. 영원히 개선하고자 한다면 결과가 아니라 시스템 단계에서 문제를 해결해야 한다.</p><h3 class="anchor anchorWithStickyNavbar_H2Uu" id="문제-3-목표는-행복을-제한한다">문제 3. 목표는 행복을 제한한다.<a href="#문제-3-목표는-행복을-제한한다" class="hash-link" aria-label="문제 3. 목표는 행복을 제한한다.에 대한 직접 링크" title="문제 3. 목표는 행복을 제한한다.에 대한 직접 링크">​</a></h3><p>목표 뒤에는 이런 가정이 내포되어 있다. &#x27;목표에 도달하면 행복해질 거야&#x27; 목표를 우선으로 생각하는 태도의 문제는 다음 표지판에 도달할 때까지 행복을 계속 미룬다는 것이다. 나는 수없이 이런 함정에 빠져 내가 뭘 하는지 잊곤 했다. 수년 동안 나에게 행복이란 미래에 있는 것이었다.</p><p>목표는 &#x27;이것 아니면 저것&#x27;이라는 양자택일적 갈등을 만들어낸다. 목표를 달성하면 성공하는 것이고, 달성하지 못하면 실패하는 것이라고 말이다. 실제 삶의 행로는 우리가 마음속으로 정해놓은 여정과 정확히 일치하지 않는다. 성공으로 가는 길은 수없이 많다. 굳이 하나의 시나리오에만 자신의 길을 맞출 이유는 없다.</p><p>시스템 우선주의는 그 해독제를 제공한다. 결과가 아니라 과정을 좋아하게 되면 &#x27;이제 행복해져도 돼&#x27;라고 말할 시기를 기다리지 않아도 된다. 시스템이 작동하고 있다면 어느 때건 만족할 수 있기 떄문이다. 시스템은 우리가 처음 상상했던 한 가지 결과가 아니라 다양한 형태로 성공할 수 있게 해준다.</p><h3 class="anchor anchorWithStickyNavbar_H2Uu" id="문제-4-목표와-장기적-발전은-다르다">문제 4. 목표와 장기적 발전은 다르다.<a href="#문제-4-목표와-장기적-발전은-다르다" class="hash-link" aria-label="문제 4. 목표와 장기적 발전은 다르다.에 대한 직접 링크" title="문제 4. 목표와 장기적 발전은 다르다.에 대한 직접 링크">​</a></h3><p>마지막으로 목표 중심적 사고방식은 &#x27;요요 현상&#x27;을 불러올 수 있다. 달기기 선수들은 경기가 있으면 몇 달 동안 열심히 운동한 끝에 결승선을 통과한다. 그리고 당분간은 훈련을  멈춘다. 이미 끝난 경기는 더 이상 동기를 자극하지 않는 것이다.</p><p>특정한 목표를 이루기 위해 노력했다면, 그것을 달성한 뒤에 무엇이 남아 우리를 앞으로 나아가게 할까? 이 때문에 많은 사람이 목표를 달성하고 나면 과거의 습관으로 쉽게 돌아가곤 한다.</p><p>목표 설정의 목적은 게임에서 이기는 것이다. 반면 시스템 구축의 목적은 게임을 계속 해나가는 것이다. 장기적으로 발전하기 위해서는 목표 설정보다는 시스템을 구축해야 한다. 성취하는 것이 아니라 계속해서 개선하고 발전해나가는 순환 고리를 만드는 것이다. 즉, &#x27;과정&#x27;에 전념하는 것이 &#x27;발전&#x27;을 결정한다.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_H2Uu" id="4-와인-앱">4. 와인 앱<a href="#4-와인-앱" class="hash-link" aria-label="4. 와인 앱에 대한 직접 링크" title="4. 와인 앱에 대한 직접 링크">​</a></h2>
<p>크롤링한 데이터를 전부 firestore에 업로드 하였다. firestore 사용량 제한이 있어서 한 번에 모두 업로드는 못하고 3~4일에 거쳐서 모두 업로드 했다. 총 28,523 개로 vivino, wine21 collection을 따로 해서 저장했다. 대략 55000 write를 했다.</p>
<p>참고로 firestore 의 경우 쓰기 2만/day, 읽기 5만/day, 삭제 2/day 까지 무료다. blaze 플랜으로 업그레이드하면 무료 사용량 초과한 만큼 비용이 발생한다.</p>
<p>이제 검색기능을 만들 차례다!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="블로그 게시물 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href="/journal/2023/07/30/"><div class="pagination-nav__sublabel">이전 게시물</div><div class="pagination-nav__label">2023.07.30</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/journal/2023/07/22/"><div class="pagination-nav__sublabel">다음 게시물</div><div class="pagination-nav__label">2023.07.22</div></a></nav></main><div class="col col--2"><div class="tableOfContents_FiDc thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#0-일상" class="table-of-contents__link toc-highlight">0. 일상</a></li><li><a href="#1-nextjs-dockerfile" class="table-of-contents__link toc-highlight">1. NextJs Dockerfile</a></li><li><a href="#2-jest-coverage-comment" class="table-of-contents__link toc-highlight">2. Jest Coverage Comment</a><ul><li><a href="#step-1-필요-패키지를-설치한다" class="table-of-contents__link toc-highlight">step 1) 필요 패키지를 설치한다.</a></li><li><a href="#step-2-ci용-jestconfig-파일을-만든다" class="table-of-contents__link toc-highlight">step 2) ci용 jest.config 파일을 만든다.</a></li></ul></li><li><a href="#3-아주-작은-습관의-힘" class="table-of-contents__link toc-highlight">3. 아주 작은 습관의 힘</a><ul><li><a href="#문제-1-성공한-사람도-성공하지-못한-사람도-목표는-같다" class="table-of-contents__link toc-highlight">문제 1. 성공한 사람도, 성공하지 못한 사람도 목표는 같다.</a></li><li><a href="#문제-2-목표-달성은-일시적-변화일-뿐이다" class="table-of-contents__link toc-highlight">문제 2. 목표 달성은 일시적 변화일 뿐이다.</a></li><li><a href="#문제-3-목표는-행복을-제한한다" class="table-of-contents__link toc-highlight">문제 3. 목표는 행복을 제한한다.</a></li><li><a href="#문제-4-목표와-장기적-발전은-다르다" class="table-of-contents__link toc-highlight">문제 4. 목표와 장기적 발전은 다르다.</a></li></ul></li><li><a href="#4-와인-앱" class="table-of-contents__link toc-highlight">4. 와인 앱</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">블로그</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/books/">책</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CFuJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/mingyu-gu-25aa761b5/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CFuJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 kooku's log, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>